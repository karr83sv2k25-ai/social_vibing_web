# Visual Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ENHANCED CHAT SCREEN                        â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    CUSTOM HEADER                      â”‚    â”‚
â”‚  â”‚  â† Back   ğŸ‘¤ Avatar   Name       â„¹ Info              â”‚    â”‚
â”‚  â”‚                    "typing..."                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚                  MESSAGE LIST                          â”‚    â”‚
â”‚  â”‚                  (FlatList)                            â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  ğŸ‘¤  [Hey there!]                    2:01 pm         â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚                [Sure! Let's do it]  ğŸ‘¤  2:03 pm      â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚                         â†“                              â”‚    â”‚
â”‚  â”‚                  [Scroll to Detect]                    â”‚    â”‚
â”‚  â”‚                         â†“                              â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                    â”‚   ğŸ”½  3      â”‚  â† Scroll to Bottom        â”‚
â”‚                    â”‚   (Badge)    â”‚     Button (Floating)      â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚               MESSAGE BOX (Fixed)                      â”‚    â”‚
â”‚  â”‚  ğŸ˜Š  ğŸ“  [Type a message...         ]  ğŸ¤/â¤          â”‚    â”‚
â”‚  â”‚                                                        â”‚    â”‚
â”‚  â”‚  [Character count: 450/500]                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STATE MANAGEMENT FLOW:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      useChatState Hook                         â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Input State  â”‚  â”‚Keyboard Stateâ”‚  â”‚ Scroll State â”‚       â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚       â”‚
â”‚  â”‚ messageText  â”‚  â”‚ keyboardVis  â”‚  â”‚autoScroll    â”‚       â”‚
â”‚  â”‚ isTyping     â”‚  â”‚ keyboardHt   â”‚  â”‚showScrollBtn â”‚       â”‚
â”‚  â”‚ cursorPos    â”‚  â”‚              â”‚  â”‚isUserScrollingâ”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Input Mode   â”‚  â”‚ Network      â”‚  â”‚ Navigation   â”‚       â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚       â”‚
â”‚  â”‚ mic/send     â”‚  â”‚ isOnline     â”‚  â”‚ backPress    â”‚       â”‚
â”‚  â”‚ isRecording  â”‚  â”‚              â”‚  â”‚ handling     â”‚       â”‚
â”‚  â”‚ duration     â”‚  â”‚              â”‚  â”‚              â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                â”‚
â”‚              â†“ AsyncStorage (Draft Persistence) â†“            â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  @chat_drafts: {                                      â”‚   â”‚
â”‚  â”‚    "chat_user123": "Unsent message...",              â”‚   â”‚
â”‚  â”‚    "chat_user456": "Another draft...",               â”‚   â”‚
â”‚  â”‚    "group_abc": "Group message..."                   â”‚   â”‚
â”‚  â”‚  }                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

USER INTERACTION FLOW:

1. USER OPENS CHAT
   â”‚
   â”œâ”€â”€> Load draft from AsyncStorage
   â”‚    â””â”€â”€> Restore unsent message (if exists)
   â”‚
   â”œâ”€â”€> Load messages from Firestore
   â”‚    â””â”€â”€> Scroll to bottom
   â”‚
   â””â”€â”€> Initialize state
        â””â”€â”€> Ready to type

2. USER TYPES MESSAGE
   â”‚
   â”œâ”€â”€> setMessageText(newText)
   â”‚    â””â”€â”€> Triggers auto-save draft (debounced 500ms)
   â”‚
   â”œâ”€â”€> setIsTyping(true)
   â”‚    â””â”€â”€> Broadcast "typing..." to other users
   â”‚    â””â”€â”€> Auto-stop after 2 seconds
   â”‚
   â””â”€â”€> Update inputMode
        â””â”€â”€> Empty â†’ mic ğŸ¤
        â””â”€â”€> Text â†’ send â¤

3. USER SCROLLS UP
   â”‚
   â”œâ”€â”€> handleScroll(event)
   â”‚    â””â”€â”€> Calculate distanceFromBottom
   â”‚
   â”œâ”€â”€> distanceFromBottom > 100px
   â”‚    â””â”€â”€> setShowScrollToBottom(true)
   â”‚    â””â”€â”€> Show floating button ğŸ”½
   â”‚
   â””â”€â”€> setShouldAutoScroll(false)
        â””â”€â”€> Prevent auto-scroll on new messages

4. NEW MESSAGE ARRIVES
   â”‚
   â”œâ”€â”€> shouldAutoScroll === true?
   â”‚    â””â”€â”€> YES: Auto-scroll to bottom
   â”‚    â””â”€â”€> NO: Increment unread badge
   â”‚
   â””â”€â”€> Update message list

5. KEYBOARD OPENS
   â”‚
   â”œâ”€â”€> handleKeyboardShow(event)
   â”‚    â””â”€â”€> setKeyboardHeight(event.endCoordinates.height)
   â”‚    â””â”€â”€> setKeyboardVisible(true)
   â”‚
   â””â”€â”€> shouldAutoScroll === true?
        â””â”€â”€> YES: Auto-scroll to show latest messages
        â””â”€â”€> NO: Keep scroll position

6. USER PRESSES BACK
   â”‚
   â”œâ”€â”€> keyboardVisible === true?
   â”‚    â””â”€â”€> YES: Dismiss keyboard (return true)
   â”‚    â””â”€â”€> NO: Navigate back (return false)
   â”‚
   â””â”€â”€> Draft auto-saved before unmount

7. USER SENDS MESSAGE
   â”‚
   â”œâ”€â”€> handleSend()
   â”‚    â””â”€â”€> Create message object
   â”‚    â””â”€â”€> Send to Firestore
   â”‚
   â”œâ”€â”€> clearMessage()
   â”‚    â””â”€â”€> setMessageText('')
   â”‚    â””â”€â”€> Clear draft from AsyncStorage
   â”‚
   â””â”€â”€> Auto-scroll to new message

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMPONENT HIERARCHY:

EnhancedChatScreen
â”œâ”€â”€ SafeAreaView
â”‚   â”œâ”€â”€ Custom Header
â”‚   â”‚   â”œâ”€â”€ Back Button
â”‚   â”‚   â”œâ”€â”€ Avatar
â”‚   â”‚   â”œâ”€â”€ Name + Status ("typing...")
â”‚   â”‚   â””â”€â”€ Info Button
â”‚   â”‚
â”‚   â””â”€â”€ KeyboardAvoidingView
â”‚       â”œâ”€â”€ FlatList (Messages)
â”‚       â”‚   â”œâ”€â”€ MessageBubble (Left)
â”‚       â”‚   â”‚   â”œâ”€â”€ Avatar
â”‚       â”‚   â”‚   â””â”€â”€ Text + Time
â”‚       â”‚   â”‚
â”‚       â”‚   â””â”€â”€ MessageBubble (Right)
â”‚       â”‚       â””â”€â”€ Text + Time
â”‚       â”‚
â”‚       â”œâ”€â”€ ScrollToBottomButton (Floating)
â”‚       â”‚   â””â”€â”€ Badge (Unread count)
â”‚       â”‚
â”‚       â””â”€â”€ MessageBox (Fixed Bottom)
â”‚           â”œâ”€â”€ Status Bar (Network/Blocked)
â”‚           â”œâ”€â”€ Recording Indicator
â”‚           â”œâ”€â”€ Input Bar
â”‚           â”‚   â”œâ”€â”€ Emoji Button ğŸ˜Š
â”‚           â”‚   â”œâ”€â”€ Attach Button ğŸ“
â”‚           â”‚   â”œâ”€â”€ TextInput (Auto-expand)
â”‚           â”‚   â””â”€â”€ Send/Mic Button â¤/ğŸ¤
â”‚           â”‚
â”‚           â””â”€â”€ Character Count

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INPUT MODE STATE MACHINE:

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ EMPTY   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ (mic ğŸ¤)â”‚                  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
          â†“                       â”‚
    User types text               â”‚
          â†“                       â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
     â”‚ TEXT    â”‚                  â”‚
     â”‚(send â¤) â”‚                  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
          â†“                       â”‚
    Long press mic                â”‚
          â†“                       â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
     â”‚RECORDINGâ”‚                  â”‚
     â”‚ (stop â¹)â”‚                  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
          â†“                       â”‚
    Release/Stop                  â”‚
          â†“                       â”‚
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCROLL BEHAVIOR DECISION TREE:

New Message Arrives
        â”‚
        â”œâ”€â”€â”€ User at bottom (< 50px)?
        â”‚    â”‚
        â”‚    YES â”€â”€> Auto-scroll âœ…
        â”‚    â”‚       â””â”€â”€> User sees new message immediately
        â”‚    â”‚
        â”‚    NO â”€â”€â”€> Don't scroll âŒ
        â”‚            â”œâ”€â”€> Increment unread badge
        â”‚            â””â”€â”€> Show scroll-to-bottom button
        â”‚
        â””â”€â”€â”€ Keyboard Opens?
             â”‚
             YES â”€â”€> shouldAutoScroll === true?
             â”‚       â”‚
             â”‚       YES â”€â”€> Auto-scroll up
             â”‚       â”‚       â””â”€â”€> Keep messages visible
             â”‚       â”‚
             â”‚       NO â”€â”€â”€> Keep scroll position
             â”‚               â””â”€â”€> Don't interrupt reading
             â”‚
             NO â”€â”€â”€> No action

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DRAFT PERSISTENCE TIMING:

User Action                     AsyncStorage Action
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Type "H"                    â”€â”€> [Wait 500ms...]
Type "He"                   â”€â”€> [Reset timer, wait 500ms...]
Type "Hey"                  â”€â”€> [Reset timer, wait 500ms...]
[Stop typing for 500ms]     â”€â”€> SAVE: "Hey"
                                 â””â”€â”€> AsyncStorage.setItem()

Navigate away               â”€â”€> SAVE: Current text
                                 â””â”€â”€> useEffect cleanup

Send message                â”€â”€> DELETE: Draft
                                 â””â”€â”€> AsyncStorage.removeItem()

App restart                 â”€â”€> LOAD: All drafts
                                 â””â”€â”€> AsyncStorage.getItem()

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NETWORK STATUS HANDLING:

Internet Connected?
        â”‚
        YES â”€â”€> Normal operation
        â”‚       â”œâ”€â”€> Send button enabled
        â”‚       â”œâ”€â”€> Messages send immediately
        â”‚       â””â”€â”€> No status banner
        â”‚
        NO â”€â”€â”€> Offline mode
                â”œâ”€â”€> Send button disabled
                â”œâ”€â”€> Show "Waiting for network..."
                â”œâ”€â”€> Queue messages locally
                â””â”€â”€> Retry when reconnected

Contact Blocked?
        â”‚
        YES â”€â”€> Block mode
                â”œâ”€â”€> Input disabled
                â”œâ”€â”€> Show "Can't send messages"
                â””â”€â”€> Red banner with ğŸš«
        â”‚
        NO â”€â”€â”€> Normal operation

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

KEYBOARD LIFECYCLE:

1. User taps TextInput
        â†“
2. keyboardWillShow (iOS) / keyboardDidShow (Android)
        â†“
3. handleKeyboardShow(event)
        â”œâ”€â”€> setKeyboardHeight(event.endCoordinates.height)
        â”œâ”€â”€> setKeyboardVisible(true)
        â””â”€â”€> Auto-scroll if shouldAutoScroll === true
        â†“
4. KeyboardAvoidingView adjusts layout
        â””â”€â”€> Pushes message list up
        â†“
5. User taps back button
        â†“
6. handleBackPress()
        â”œâ”€â”€> keyboardVisible === true?
        â”‚    â””â”€â”€> YES: Keyboard.dismiss() + return true
        â””â”€â”€> NO: return false (navigate back)
        â†“
7. keyboardWillHide (iOS) / keyboardDidHide (Android)
        â†“
8. handleKeyboardHide()
        â”œâ”€â”€> setKeyboardVisible(false)
        â””â”€â”€> setKeyboardHeight(0)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PERFORMANCE OPTIMIZATIONS:

FlatList Rendering Strategy:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Off-screen (top)    â† Not rendered (removed)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Render Window       â† Messages 1-30 (visible + buffer)    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Visible Area    â† Messages 11-20 (actually visible)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Off-screen (bottom) â† Not rendered (removed)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Settings:
- initialNumToRender: 20    (First render)
- maxToRenderPerBatch: 10   (Per scroll batch)
- windowSize: 21            (21 viewports maintained)
- removeClippedSubviews: true (Remove off-screen)

Draft Saving Debounce:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Time:  0ms   100ms  200ms  300ms  400ms  500ms            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Type:   H      e      l      l      o     [STOP]          â”‚
â”‚ Save:   âœ—      âœ—      âœ—      âœ—      âœ—      âœ“ SAVE!       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Result: Only 1 AsyncStorage write instead of 5!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

This visual diagram shows the complete architecture and flow of
the WhatsApp-style message box implementation.
```
